<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="//favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="nullhttp://7xohxb.com1.z0.glb.clouddn.com/static/images/logo.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Muyan Xia</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>Tags</li>
						
						<li>友情链接</li>
						
						
						<li>Über</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/2016Note/" style="font-size: 20px;">2016Note</a> <a href="/tags/2017Note/" style="font-size: 10px;">2017Note</a> <a href="/tags/Consul/" style="font-size: 10px;">Consul</a> <a href="/tags/MQTT/" style="font-size: 10px;">MQTT</a> <a href="/tags/Payment/" style="font-size: 20px;">Payment</a> <a href="/tags/Swagger/" style="font-size: 10px;">Swagger</a> <a href="/tags/python/" style="font-size: 16.67px;">python</a> <a href="/tags/分布式/" style="font-size: 10px;">分布式</a> <a href="/tags/杂谈/" style="font-size: 13.33px;">杂谈</a> <a href="/tags/笔记/" style="font-size: 16.67px;">笔记</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">奥巴马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">本泽马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">吉格斯的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">习大大大不同</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Muyan Xia</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img lazy-src="nullhttp://7xohxb.com1.z0.glb.clouddn.com/static/images/logo.jpg" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Muyan Xia</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-SpringBoot Consul Swagger" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/07/SpringBoot Consul Swagger/" class="article-date">
  	<time datetime="2016-09-07T00:30:02.000Z" itemprop="datePublished">2016-09-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/07/SpringBoot Consul Swagger/">SpringBoot Consul Swagger</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- toc -->
<h2 id="组件分布">组件分布</h2><table>
<thead>
<tr>
<th>组件</th>
<th>版本</th>
<th>用途</th>
<th>URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>Spring Boot</td>
<td>1.4.0</td>
<td>代容器</td>
<td><a href="http://projects.spring.io/spring-boot/" target="_blank" rel="external">http://projects.spring.io/spring-boot/</a></td>
</tr>
<tr>
<td>Consul</td>
<td>0.7.5</td>
<td>注册配置中心</td>
<td><a href="https://www.consul.io/intro/getting-started/install.html" target="_blank" rel="external">https://www.consul.io/intro/getting-started/install.html</a></td>
</tr>
<tr>
<td>Swagger</td>
<td>2.10.4</td>
<td>API管理</td>
<td><a href="http://swagger.io/" target="_blank" rel="external">http://swagger.io/</a></td>
</tr>
<tr>
<td>Hystrix</td>
<td>1.5.10</td>
<td>弹性框架</td>
<td><a href="https://github.com/Netflix/Hystrix" target="_blank" rel="external">https://github.com/Netflix/Hystrix</a></td>
</tr>
<tr>
<td>jwt</td>
<td>3.0.1</td>
<td>认证框架</td>
<td><a href="https://github.com/auth0/java-jwt" target="_blank" rel="external">https://github.com/auth0/java-jwt</a></td>
</tr>
</tbody>
</table>
<h2 id="Consul">Consul</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载地址 https://www.consul.io/downloads.html</span></span><br><span class="line"><span class="built_in">cd</span>  /tmp  &amp; wget https://releases.hashicorp.com/consul/<span class="number">0.7</span>.<span class="number">5</span>/consul_0.<span class="number">7.5</span>_linux_amd64.zip?_ga=<span class="number">1.14278835</span>.<span class="number">504518699.1489382125</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># WEB UI</span></span><br><span class="line">wget https://releases.hashicorp.com/consul/<span class="number">0.7</span>.<span class="number">5</span>/consul_0.<span class="number">7.5</span>_web_ui.zip?_ga=<span class="number">1.216705042</span>.<span class="number">504518699.1489382125</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Server </span></span><br><span class="line">/usr/<span class="built_in">local</span>/consul/consul agent -server -bootstrap-expect <span class="number">2</span> -data-dir ./tmp/consul -node=n56 -bind=<span class="number">10.0</span>.<span class="number">21.56</span> -ui-dir ./dist -datacenter=dc1  &amp;</span><br><span class="line">/usr/<span class="built_in">local</span>/consul/consul  agent -server -bootstrap-expect <span class="number">2</span> -data-dir ./tmp/consul -node=n57 -bind=<span class="number">10.0</span>.<span class="number">21.57</span> -ui-dir ./dist -datacenter=dc1  &amp;</span><br><span class="line">/usr/<span class="built_in">local</span>/consul/consul  agent -server -bootstrap-expect <span class="number">2</span> -data-dir ./tmp/consul -node=n58 -bind=<span class="number">10.0</span>.<span class="number">21.58</span> -ui-dir ./dist -datacenter=dc1  &amp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启之后不生效可以在命令后面加 -rejoin</span></span><br><span class="line"><span class="comment">## 组件集群(在57和58执行)</span></span><br><span class="line">/usr/<span class="built_in">local</span>/consul/consul join <span class="number">10.0</span>.<span class="number">21.56</span> &amp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Agent </span></span><br><span class="line">/usr/<span class="built_in">local</span>/consul/consul agent -data-dir ./tmp/consul -ui -client=<span class="number">0.0</span>.<span class="number">0.0</span>  -node=n59  -bind=<span class="number">10.0</span>.<span class="number">21.59</span>  -datacenter=dc1</span><br><span class="line"></span><br><span class="line">拉起来之后的一直</span><br><span class="line">http://<span class="number">10.0</span>.<span class="number">21.59</span>:<span class="number">8500</span>/</span><br><span class="line"><span class="comment">## Agent加入集群</span></span><br><span class="line">./consul join <span class="number">10.0</span>.<span class="number">21.57</span> &amp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 服务注册以及健康检查</span></span><br><span class="line"></span><br><span class="line">consul agent -data-dir ./tmp/consul -ui -bind=<span class="number">10.0</span>.<span class="number">21.59</span> -dc=dc1 -config-file=./conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看集群状态</span></span><br><span class="line">consul  operator raft -list-peers</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 退出</span></span><br><span class="line">consul  leave</span><br><span class="line"></span><br><span class="line"><span class="comment"># UI</span></span><br></pre></td></tr></table></figure>
<h3 id="Consul_Commands">Consul Commands</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ consul</span><br><span class="line">usage: consul [<span class="comment">--version] [--help] &lt;command&gt; [&lt;args&gt;] </span></span><br><span class="line"></span><br><span class="line">$ consul join -h  : get join <span class="operator"><span class="keyword">help</span></span><br><span class="line"></span><br><span class="line">Available commands <span class="keyword">are</span>:</span><br><span class="line">    <span class="keyword">agent</span>          Runs a Consul <span class="keyword">agent</span></span><br><span class="line">    <span class="keyword">event</span>          Fire a <span class="keyword">new</span> <span class="keyword">event</span></span><br><span class="line">    exec           Executes a command <span class="keyword">on</span> Consul nodes</span><br><span class="line">    <span class="keyword">force</span>-leave    Forces a <span class="keyword">member</span> <span class="keyword">of</span> the cluster <span class="keyword">to</span> enter the <span class="string">"left"</span> state</span><br><span class="line">    info           Provides debugging information <span class="keyword">for</span> operators</span><br><span class="line">    <span class="keyword">join</span>           Tell Consul <span class="keyword">agent</span> <span class="keyword">to</span> <span class="keyword">join</span> cluster</span><br><span class="line">    keygen         Generates a <span class="keyword">new</span> encryption <span class="keyword">key</span></span><br><span class="line">    keyring        Manages gossip layer encryption <span class="keyword">keys</span></span><br><span class="line">    leave          Gracefully <span class="keyword">leaves</span> the Consul cluster <span class="keyword">and</span> shuts down</span><br><span class="line">    <span class="keyword">lock</span>           <span class="keyword">Execute</span> a command holding a <span class="keyword">lock</span></span><br><span class="line">    members        Lists the members <span class="keyword">of</span> a Consul cluster</span><br><span class="line">    monitor        Stream <span class="keyword">logs</span> <span class="keyword">from</span> a Consul <span class="keyword">agent</span></span><br><span class="line">    <span class="keyword">operator</span>       Provides cluster-<span class="keyword">level</span> tools <span class="keyword">for</span> Consul operators</span><br><span class="line">    reload         <span class="keyword">Triggers</span> the <span class="keyword">agent</span> <span class="keyword">to</span> reload configuration files</span><br><span class="line">    rtt            Estimates network <span class="keyword">round</span> trip <span class="keyword">time</span> <span class="keyword">between</span> nodes</span><br><span class="line">    <span class="keyword">version</span>        Prints the Consul <span class="keyword">version</span></span><br><span class="line">    watch          Watch <span class="keyword">for</span> changes <span class="keyword">in</span> Consul</span></span><br></pre></td></tr></table></figure>
<h2 id="Swagger">Swagger</h2><h2 id="注册服务">注册服务</h2><p><a href="http://www.blogs8.cn/posts/WOW1b9c" target="_blank" rel="external">http://www.blogs8.cn/posts/WOW1b9c</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Consul/">Consul</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swagger/">Swagger</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分布式/">分布式</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/技术/">技术</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-技术各职位的区别" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/27/技术各职位的区别/" class="article-date">
  	<time datetime="2016-06-27T05:18:13.000Z" itemprop="datePublished">2016-06-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/27/技术各职位的区别/">技术职位的区别</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h1 id="一、高级程序员">一、高级程序员</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">如果你是一个刚刚创业的公司，公司没有专职产品经理和项目经理，你就是公司的产品经理，你如果对你现在的开发员能力不满，那么你只需要的是一个高级程序员。</span><br><span class="line"></span><br><span class="line">你定义功能、你做计划推进和管理，他可以带<span class="number">1</span>-<span class="number">2</span>个副手把你规划的功能实现了，他是主力干活者，有技术难题也是他来亲自攻克解决。</span><br><span class="line"></span><br><span class="line">所以，一个高级程序员，他的职责很清晰：</span><br><span class="line"><span class="number">1</span>、负责核心复杂功能的实现方案设计、编码实现</span><br><span class="line"><span class="number">2</span>、负责疑难BUG分析诊断、攻关解决</span><br></pre></td></tr></table></figure>
<h1 id="二、研发Leader">二、研发Leader</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">公司再长大些。如果你就有一个研发团队（含产品/开发/测试），你就一套主产品，而且你的研发团队小于<span class="number">15</span>人，那么你需要的就是一个研发Leader。</span><br><span class="line"></span><br><span class="line">因为你已经有了<span class="number">1</span>-<span class="number">2</span>个高级程序员，核心难题攻克和核心功能研发进度与质量保证，已经可以靠他们自身能力解决掉了。那么你需要研发Leader干什么。</span><br><span class="line"></span><br><span class="line">研发Leader的职责是：</span><br><span class="line"><span class="number">1</span>、团队任务管理：开发工作量评估、开发任务分配</span><br><span class="line"><span class="number">2</span>、团队生产质量提升：代码审核、开发风险识别/报告/协调解决</span><br><span class="line"><span class="number">3</span>、团队生产力提升：代码模板研发与推广、最佳实践规范总结与推广、自动化研发生产工具研发与推广</span><br><span class="line"><span class="number">4</span>、团队专业力提升：招聘面试、新人指导、领导复盘总结改进</span><br></pre></td></tr></table></figure>
<h1 id="三、技术总监">三、技术总监</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">如果你的研发团队超过<span class="number">20</span>人了，而且有多套主打产品线了，你可能已经有了多个研发Leader了，那么你需要一个技术总监。</span><br><span class="line"></span><br><span class="line">技术总监的职责：</span><br><span class="line"><span class="number">1</span>、组建平台研发部，搭建公共技术平台，方便上面各条产品线开发。</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、通过技术平台、通过高一层的职权，管理和协调各个产品线组。现在每个产品线都应该有合格的研发Leader和高级程序员了。</span><br></pre></td></tr></table></figure>
<h1 id="四、首席架构师">四、首席架构师</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">因为你已经有了技术总监了，所以技术平台不错了。技术平台和各条产品线的协调互动，也是技术总监管着。</span><br><span class="line"></span><br><span class="line">因为你已经有了各个产品线的高级程序员，他们在靠个人能力维持着核心功能模块的开发进度和代码质量。</span><br><span class="line"></span><br><span class="line">因为你已经有了研发Leader，所以代码模板研发与推广、最佳实践规范总结与推广，这些事都已经在日常按份内职责开展了。</span><br><span class="line"></span><br><span class="line">那么，啥时候需要首席架构师啊。</span><br><span class="line"></span><br><span class="line">也就是说，需要分离管理族和专业族了。你会发现，这个阶段你的研发团队已经超过<span class="number">100</span>来人了，需要有人专注来做架构规划、设计、日常维护。不能让研发总监和研发Leader又做管理又做技术一股脑都扔给他们，你就等着总结果产出。这是不对的。</span><br><span class="line"></span><br><span class="line">需要从技术总监和研发Leader身上剥离职责了。让技术总监和研发Leader偏项目管理（管理族），把各个模块之间的架构设计工作，独立出一个岗位，就是架构师，来负责。</span><br><span class="line"></span><br><span class="line">每个产品线都有架构师，在技术平台部门也有技术平台的架构师。那么，技术平台和业务产品线的架构互动，就是首席架构师在衔接了。让技术平台架构能够和产品业务系统的架构互相促进和支撑，就是首席架构师的份内之事。</span><br><span class="line"></span><br><span class="line">架构师的职责是：</span><br><span class="line"><span class="number">1</span>、架构分析：从功能性需求中识别出需要增加的非功能性需求，好满足性能、可扩展、解耦/集成、安全、可运维、高可用、易部署、易更新。并且识别完非功能型需求，还要做技术选型、技术架构风险识别、技术实现工作量评估</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、架构设计与实现：非功能性模块的架构设计、接口设计、代码实现。所以需要的是有代码实现能力还要有架构思维的工程师，不需要画PPT的工程师</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、业务架构设计与实现：需要对跨系统的接口进行识别、实现、维护，需要对能写成公共代码类库的进行分析、识别、接口设计、实现、变更维护。</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、重构：架构师需要经常做Bug分析、非模板性和公共类库代码检查，以发现代码腐烂程度，以发现还有哪些代码没有做很好的架构与精心的代码设计。所以重构是经常性维护发生的，不是攒到某一刻动大手术，甚至推翻重做，那就不叫重构了。</span><br></pre></td></tr></table></figure>
<h1 id="五、CTO">五、CTO</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">你把架构师团队组织建立完成，再往大长，你才需要真正意义上的CTO了。否则你一开始就招真正的CTO，他也不满意，你的期望也不对。现在你的期望也对了，他的能力模型也正好和你的期望职能匹配了，你能给他的和他想要的也正好匹配了。</span><br><span class="line"></span><br><span class="line">有的公司有软件系统产品副总裁，也有软件系统技术副总裁，而且把软件系统技术副总裁叫CTO，软件系统产品副总裁叫产品VP。这就很怪异。</span><br><span class="line"></span><br><span class="line">真正的CTO，是软件产品和技术是统一管理的。</span><br><span class="line"></span><br><span class="line">他做的事情，是商业、产品、技术、管理、团队相平衡的综合统管。</span><br><span class="line"></span><br><span class="line">CTO的职责：</span><br><span class="line"><span class="number">1</span>、业绩达成：洞察客户需求，捕捉商业机会，规划技术产品，通过技术产品领导业务增长，有清晰的战略规划、主攻方向，带领团队实现组织目标</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、前沿与平台：到这个研发规模规模级别了，一定要有专门的团队做技术应用创新探索和前沿技术预研。而且要和技术平台团队、应用研发团队形成很好的联动作用，让创新原型试点能够很平滑的融入商业平台再让应用研发线规模化的使用起来。大量的前沿探索都死在了内部，做完试点就停滞了，这就需要CTO做好整体的衔接推动工作。</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、研发过程管理：站在全局立场来端到端改进业务流程，为业务增长提供方便</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、组织与人才建设：公司文化和价值观的传承；研发专业族团队梯队建制建设、研发管理族团队梯队建制建设；创建创新激发机制，激发研发人创新向前发展，激发黑马人脱颖而出</span><br></pre></td></tr></table></figure>
<img title="imageTitle" alt="Desc" class="class1" src="http://7xohxb.com1.z0.glb.clouddn.com/static/images/baofoo.png?imageView2/2/w/600">
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2016Note/">2016Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Payment/">Payment</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-ELK-Stack" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/23/ELK-Stack/" class="article-date">
  	<time datetime="2016-04-23T07:11:57.000Z" itemprop="datePublished">2016-04-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/23/ELK-Stack/">ELK Stack</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h1 id="安装">安装</h1><h2 id="系统环境">系统环境</h2><pre><code><span class="attribute">System</span>: Centos  <span class="number">6.6</span> X64
<span class="attribute">ElasticSearch</span>: <span class="number">2.3</span>.<span class="number">2</span>
<span class="attribute">Logstash</span>: <span class="number">2.3</span>.<span class="number">2</span>
<span class="attribute">Kibana</span>: <span class="number">4.5</span>.<span class="number">0</span>
<span class="attribute">Java</span>: openjdk version  <span class="string">"1.8.0_77"</span>
groupadd elk
useradd -g elk elk  
passwd elk<span class="variable">@506</span> 
su elk
</code></pre><h2 id="下载包">下载包</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/sh</span></span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">wget --no-check-certificate https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/tar/elasticsearch/<span class="number">2.3</span>.<span class="number">2</span>/elasticsearch-<span class="number">2.3</span>.<span class="number">2</span>.tar.gz</span><br><span class="line">wget --no-check-certificate  https://download.elastic.co/logstash/logstash/logstash-<span class="number">2.3</span>.<span class="number">2</span>.tar.gz</span><br><span class="line">wget --no-check-certificate https://download.elastic.co/kibana/kibana/kibana-<span class="number">4.5</span>.<span class="number">0</span>-linux-x64.tar.gz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/elasticsearch-<span class="number">2.3</span>.<span class="number">2</span>/</span><br><span class="line"><span class="comment">#安装head插件</span></span><br><span class="line"> ./bin/plugin  install mobz/elasticsearch-head</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置开始</span></span><br><span class="line"><span class="shebang">#!/bin/sh</span></span><br><span class="line"><span class="comment"># elasticsearch</span></span><br><span class="line"><span class="comment"># 集群名称，集群内相同</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"cluster.name: my-application"</span> &gt;&gt;/usr/<span class="built_in">local</span>/elasticsearch-<span class="number">2.3</span>.<span class="number">2</span>/config/elasticsearch.yml</span><br><span class="line"><span class="comment"># 节点名称，必须不同</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"node.name: node-1"</span> &gt;&gt;/usr/<span class="built_in">local</span>/elasticsearch-<span class="number">2.3</span>.<span class="number">2</span>/config/elasticsearch.yml</span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"node.rack: r1"</span> &gt;&gt;/usr/<span class="built_in">local</span>/elasticsearch-<span class="number">2.3</span>.<span class="number">2</span>/config/elasticsearch.yml</span><br><span class="line">mkdir -p /data/elasticsearch/data</span><br><span class="line">mkdir -p /data/elasticsearch/logs</span><br><span class="line"><span class="comment"># 数据目录</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"path.data: /data/elasticsearch/data"</span> &gt;&gt;/usr/<span class="built_in">local</span>/elasticsearch-<span class="number">2.3</span>.<span class="number">2</span>/config/elasticsearch.yml</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"path.logs: /data/elasticsearch/logs"</span> &gt;&gt;/usr/<span class="built_in">local</span>/elasticsearch-<span class="number">2.3</span>.<span class="number">2</span>/config/elasticsearch.yml</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"network.host: 192.168.75.131"</span> &gt;&gt;/usr/<span class="built_in">local</span>/elasticsearch-<span class="number">2.3</span>.<span class="number">2</span>/config/elasticsearch.yml</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"http.port: 9200"</span> &gt;&gt;/usr/<span class="built_in">local</span>/elasticsearch-<span class="number">2.3</span>.<span class="number">2</span>/config/elasticsearch.yml</span><br><span class="line"><span class="comment">#discovery.zen.ping.unicast.hosts: ["host1", "host2"]</span></span><br><span class="line"><span class="comment">#gateway.recover_after_nodes: 3</span></span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>
<h2 id="Yum安装">Yum安装</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rpm --import http:<span class="comment">//packages.elasticsearch.org/GPG-KEY-elasticsearch</span></span><br><span class="line">cat &gt; /etc/yum<span class="class">.repos</span><span class="class">.d</span>/logstash<span class="class">.repo</span> &lt;&lt;EOF</span><br><span class="line">[logstash-<span class="number">1.5</span>]</span><br><span class="line">name=logstash repository <span class="keyword">for</span> <span class="number">1.5</span><span class="class">.x</span> packages</span><br><span class="line">baseurl=http:<span class="comment">//packages.elasticsearch.org/logstash/1.5/centos</span></span><br><span class="line">gpgcheck=<span class="number">1</span></span><br><span class="line">gpgkey=http:<span class="comment">//packages.elasticsearch.org/GPG-KEY-elasticsearch</span></span><br><span class="line">enabled=<span class="number">1</span></span><br><span class="line">EOF</span><br><span class="line">yum clean all</span><br><span class="line">yum install logstash</span><br></pre></td></tr></table></figure>
<h1 id="运行">运行</h1><p>bin/logstash -e ‘input{stdin{}}output{stdout{codec=&gt;rubydebug}}’</p>
<p>#<br><img src="http://kibana.logstash.es/content/logstash/images/logstash-arch.jpg" alt="Logstash角色"></p>
<p><a href="http://kibana.logstash.es/content/logstash/get_start/daemon.html" target="_blank" rel="external">http://kibana.logstash.es/content/logstash/get_start/daemon.html</a></p>
<h1 id="利用_Redis_队列扩展_logstash">利用 Redis 队列扩展 logstash</h1><p><a href="http://blog.csdn.net/kmtong/article/details/38920327" target="_blank" rel="external">http://blog.csdn.net/kmtong/article/details/38920327</a></p>
<img title="imageTitle" alt="Desc" class="class1" src="http://7xohxb.com1.z0.glb.clouddn.com/static/images/baofoo.png?imageView2/2/w/600">
<p>[1][<a href="http://my.oschina.net/itblog/blog/547250" target="_blank" rel="external">http://my.oschina.net/itblog/blog/547250</a>]<br>[2][<a href="http://my.oschina.net/gudaoxuri/blog/534710" target="_blank" rel="external">http://my.oschina.net/gudaoxuri/blog/534710</a>]</p>
<p>飞轮租车<br>轮玩<br>飞轮嗨<br>酷go<br>悠见<br>悠见代步<br>OCar<br>步千里<br>随行易<br>悠行<br>风轮 windwell<br>OO<br>轮行天下<br>神龙行，云行客，神行飘<br>航游</p>
<hr>
<p><a href="http://ehire.51job.com/Candidate/ResumeViewSingle.aspx?CtmID=1432725&amp;TableName=temp&amp;SeqID=54238577&amp;UserID=501757362&amp;HruID=1724595&amp;AccessKey=stTr6xgYHWPFmQwSYliJCfhaIuJFsOhzIeRIRgCQ&amp;Tranlang=&amp;v=1" target="_blank" rel="external">http://ehire.51job.com/Candidate/ResumeViewSingle.aspx?CtmID=1432725&amp;TableName=temp&amp;SeqID=54238577&amp;UserID=501757362&amp;HruID=1724595&amp;AccessKey=stTr6xgYHWPFmQwSYliJCfhaIuJFsOhzIeRIRgCQ&amp;Tranlang=&amp;v=1</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2016Note/">2016Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Payment/">Payment</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-PDF转Image" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/14/PDF转Image/" class="article-date">
  	<time datetime="2016-04-14T13:04:58.000Z" itemprop="datePublished">2016-04-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/14/PDF转Image/">PDF转Image</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h1 id="依赖">依赖</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>pdfbox<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>pdfbox-tools<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>fontbox<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="代码">代码</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">package com.baofoo.commons.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.pdmodel.PDDocument;</span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.pdmodel.PDPage;</span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.rendering.ImageType;</span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.rendering.PDFRenderer;</span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.tools.imageio.ImageIOUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *</span><br><span class="line"> * &lt;p/&gt;</span><br><span class="line"> * &lt;p&gt;PDF转图片</span><br><span class="line"> * @author muyan@baofoo.com</span><br><span class="line"> * @version 1.0.0 Created on 2016/4/14.</span><br><span class="line"> * @see</span><br><span class="line"> * @since 1.7</span><br><span class="line"> */</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">PDFUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    private  static <span class="built_in">String</span>  PDF_FILE_URL =<span class="string">"c:\\Users\\Administrator\\桌面\\jenkins+maven+git.pdf"</span>;</span><br><span class="line"></span><br><span class="line">     private  static <span class="built_in">String</span>  PNG_FILE_URL =<span class="string">"c:\\Users\\Administrator\\桌面\\jenkins+maven+git.pdf"</span>;</span><br><span class="line"></span><br><span class="line">    public static <span class="keyword">void</span> main(<span class="built_in">String</span>[] args) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">        PDDocument <span class="built_in">document</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="built_in">document</span> = PDDocument.load(<span class="keyword">new</span> File(PDF_FILE_URL));</span><br><span class="line">            PDFRenderer pdfRenderer = <span class="keyword">new</span> PDFRenderer(<span class="built_in">document</span>);</span><br><span class="line">            int pageCounter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (PDPage page : <span class="built_in">document</span>.getPages())&#123;</span><br><span class="line">                BufferedImage bim = pdfRenderer.renderImageWithDPI(pageCounter, <span class="number">300</span>, ImageType.RGB);</span><br><span class="line">                ImageIOUtil.writeImage(bim, PDF_FILE_URL + <span class="string">"-"</span> + (pageCounter++) + <span class="string">".png"</span>, <span class="number">300</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">document</span>.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">//todo</span></span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="多页PDF转一张长图">多页PDF转一张长图</h1><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">private</span>  <span class="keyword">static</span> <span class="built_in">String</span>  PDF_FILE_URL =<span class="string">"c:\\Users\\Administrator\\桌面\\jenkins+maven+git.pdf"</span>;</span><br><span class="line">   <span class="keyword">private</span>  <span class="keyword">static</span> <span class="built_in">String</span>  JPG_FILE_URL =<span class="string">"c:\\Users\\Administrator\\桌面\\"</span>;</span><br><span class="line">   <span class="keyword">private</span>  <span class="keyword">static</span> <span class="built_in">String</span>  FILE_NAME = <span class="string">"PDFtoIMG.jpg"</span>;</span><br><span class="line">PDDocument <span class="built_in">document</span> = <span class="literal">null</span>;</span><br><span class="line">       PDDocument <span class="built_in">document</span> = <span class="literal">null</span>;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="built_in">document</span> = PDDocument.load(<span class="keyword">new</span> File(PDF_FILE_URL));</span><br><span class="line">           PDFRenderer pdfRenderer = <span class="keyword">new</span> PDFRenderer(<span class="built_in">document</span>);</span><br><span class="line">           int pageCounter = <span class="number">0</span>;</span><br><span class="line">           BufferedImage bim = pdfRenderer.renderImageWithDPI(pageCounter, <span class="number">300</span>, ImageType.RGB);</span><br><span class="line">           BufferedImage combined = <span class="keyword">new</span> BufferedImage(bim.getWidth()  ,</span><br><span class="line">                   bim.getHeight()* <span class="built_in">document</span>.getNumberOfPages()+<span class="number">1</span>, ImageType.RGB);</span><br><span class="line">           Graphics g = combined.getGraphics();</span><br><span class="line">           <span class="keyword">for</span> (PDPage page : <span class="built_in">document</span>.getPages())&#123;</span><br><span class="line">                bim = pdfRenderer.renderImageWithDPI(pageCounter, <span class="number">300</span>, ImageType.RGB);</span><br><span class="line">               g.drawImage(bim,  <span class="number">0</span>,bim.getHeight() * pageCounter, <span class="literal">null</span>);</span><br><span class="line">               pageCounter++;</span><br><span class="line">           &#125;</span><br><span class="line">           ImageIO.write(combined, <span class="string">"JPG"</span>, <span class="keyword">new</span> File(JPG_FILE_URL, FILE_NAME));</span><br><span class="line">       &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">           org.apache.pdfbox.io.IOUtils.closeQuietly(<span class="built_in">document</span>);</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>
<img title="imageTitle" alt="Desc" class="class1" src="http://7xohxb.com1.z0.glb.clouddn.com/static/images/baofoo.png?imageView2/2/w/600">
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2016Note/">2016Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Payment/">Payment</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-代码库迁移攻略" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/01/代码库迁移攻略/" class="article-date">
  	<time datetime="2016-04-01T05:22:06.000Z" itemprop="datePublished">2016-04-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/01/代码库迁移攻略/">代码库迁移攻略</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h1 id="为什么要迁移">为什么要迁移</h1><ul>
<li>SVN的分支管理模式不适用现在开发的需求。</li>
<li>经过测试环境近半年的Gitlab试用奠定基础。</li>
<li>为自动化部署，持续集成向前再迈进一步。</li>
</ul>
<h1 id="迁移的好处">迁移的好处</h1><ul>
<li>分布式的代码管理，随时提交。</li>
<li>全量部署，再也不用担心代码不全。</li>
<li>线上，测试，开发都有分支互相不影响吗，减少折腾。</li>
</ul>
<h1 id="迁移的准备工作">迁移的准备工作</h1><table>
<thead>
<tr>
<th>事项</th>
<th>进度</th>
<th>时间要求</th>
<th>责任人</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>新库安装（域名配置，SSH端口配置）</td>
<td>已经申请</td>
<td>4月5日</td>
<td>无名</td>
<td>完成</td>
</tr>
<tr>
<td>Git分支管理</td>
<td>已经完成</td>
<td>3月28日</td>
<td>谢汶达</td>
<td>完成</td>
</tr>
<tr>
<td>WEB应用监控</td>
<td>文档输出</td>
<td>3月31日</td>
<td>谢汶达</td>
<td>完成</td>
</tr>
</tbody>
</table>
<p>#<br><a href="http://gitlab.baofoo.net/" target="_blank" rel="external">新库地址</a></p>
<p>#<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">项目迁移顺序</span><br><span class="line">代码管理员</span><br><span class="line">分支</span><br></pre></td></tr></table></figure></p>
<img title="imageTitle" alt="Desc" class="class1" src="http://7xohxb.com1.z0.glb.clouddn.com/static/images/baofoo.png?imageView2/2/w/600">
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2016Note/">2016Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Payment/">Payment</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-代码检查与评审" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/31/代码检查与评审/" class="article-date">
  	<time datetime="2016-03-31T02:23:08.000Z" itemprop="datePublished">2016-03-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/31/代码检查与评审/">代码检查与评审</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]<br>软件开发人员通常不会考虑的一种测试形式-人工测试。</p>
<p>大多数人都以为，因为程序是为了供机器执行而编写的，那么也该由机器来对程序进行测试。这种想法是有问题的。人工测试方法在暴露错误方面是很有成效的。实际上，大多数的软件项目都应使用到一下的人工测试方法：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 利用错误列表进行代码检查</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 小组代码走查</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 桌面检查</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 同行评审</span><br></pre></td></tr></table></figure></p>
<p>#代码检查：</p>
<p>所谓代码检查是以组为单位阅读代码，它是一系列规程和错误检查技术的集合。</p>
<p>一个代码检查小组通常由四人组成：</p>
<p>协调人：以为称职的程序员<br>该程序的编码人员<br>该程序的设计人员<br>测试专家<br>用于代码检查的错误列表：</p>
<h2 id="数据引用错误">数据引用错误</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">是否有引用的变量未赋值或未初始化</span><br><span class="line">下标的值是否在范围之内</span><br><span class="line">是否存在非整数下标</span><br><span class="line">是否存在虚调用</span><br><span class="line">当使用别名时属性是否正确</span><br><span class="line">记录和结构的属性是否匹配</span><br><span class="line">是否计算位串的地址，是否传递位串参数</span><br><span class="line">基础的存储属性是否正确</span><br><span class="line">跨过程的结构定义是否匹配</span><br><span class="line">索引或下标操作是否有“仅差一个”的错误</span><br><span class="line">继承需求是否得到满足</span><br></pre></td></tr></table></figure>
<h2 id="数据声明错误">数据声明错误</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">是否所有的变量都已声明</span><br><span class="line">默认的属性是否被正确理解？</span><br><span class="line">数组和字符串的初始化是否正确？</span><br><span class="line">变量是否赋予了正确的长度，类型和存储类</span><br><span class="line">初始化是否与存储类相一致？</span><br><span class="line">是否有相似的变量名？</span><br></pre></td></tr></table></figure>
<h2 id="运算错误">运算错误</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">是否存在非算术变量间的运算？</span><br><span class="line">是否存在混合摸式的运算？</span><br><span class="line">是否存在不同字长变量问的运算？</span><br><span class="line">目标变量的大小是否小于赋值大小？</span><br><span class="line">中间结果是否上溢或下溢？</span><br><span class="line">是否存住被<span class="number">0</span>除？</span><br><span class="line">是否存在二进制的不精确度？</span><br><span class="line">变量的值是否超过了有意义的范围？</span><br><span class="line">操作符的优先顺序是否被正确理解？</span><br><span class="line">整数除法是否正确？</span><br></pre></td></tr></table></figure>
<h2 id="比较错误">比较错误</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">是否存在不同类型变量间的比较？</span><br><span class="line">是否存在混合模式的比较运算？</span><br><span class="line">比较运算符是否正确？</span><br><span class="line">布尔表达式是否正确？</span><br><span class="line">比较运算是是否与布尔表达式相混合？</span><br><span class="line">是否存在二进制小数的比较？</span><br><span class="line">操作符的优先顺序是否被正确理解？</span><br><span class="line">编译器对布尔表达武的计算方式是否被正确理解？</span><br></pre></td></tr></table></figure>
<h2 id="控制流程错误">控制流程错误</h2><figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">是否超出了多条分支路径？</span><br><span class="line">是否每个循环都终止了？</span><br><span class="line">是否每个程序都终止了？</span><br><span class="line">是否存在由于入口条件不满足而跳过循环体？</span><br><span class="line">肯能的循环越界是否正确？</span><br><span class="line">是否存在“仅差一个”的迭代错误？</span><br><span class="line"><span class="keyword">DO</span>/<span class="keyword">END</span>语句是否匹配？</span><br><span class="line">是否存在不能穷尽的判断？</span><br><span class="line">输出信息中是否有文字或语法错误？</span><br></pre></td></tr></table></figure>
<h2 id="接口错误">接口错误</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">形参的数量是否等于实参的数量？</span><br><span class="line">形参的量纲是否与实参的量纲相匹配？</span><br><span class="line">传递给被调用模块的实参个数是否等于其形参个数？</span><br><span class="line">传递给被调用模块的实参属性是否与其形参属性匹配？</span><br><span class="line">传递给被调用模块的实参量纲是否与其形参量纲匹配？</span><br><span class="line">调用内部函数的实参的数量、属性，顺序是否正确？</span><br><span class="line">是否引用了与当前入口点无关的形参？</span><br><span class="line">是否改变了某个原本仅为输入值的形参？</span><br><span class="line">全局变量的定义在模块间是否一致？</span><br><span class="line">常数是否以实参形式传递过？</span><br></pre></td></tr></table></figure>
<h2 id="输入/输出错误">输入/输出错误</h2><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">文件的属性是否正确？</span><br><span class="line">OPEN语句是否正确？</span><br><span class="line"><span class="keyword">I</span>/<span class="keyword">O</span>语句是否符合格式规范</span><br><span class="line">缓冲大小与记录大小是否匹配？</span><br><span class="line">文件在使用前是否打开？</span><br><span class="line">文件在使用后是否关闭？</span><br><span class="line">文件结束条件是否被正确处理？</span><br><span class="line">是否处理了<span class="keyword">I</span>/<span class="keyword">O</span>错误？</span><br></pre></td></tr></table></figure>
<h2 id="其他检查">其他检查</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">在交叉引用列表中是否存在未引用过的变量？</span><br><span class="line">属性列表是否与预期的相一致？</span><br><span class="line">是否存在“警告”或“提示”信息？</span><br><span class="line">是否对输入的合法性进行了检查？</span><br><span class="line">是否遗漏了某个功能？</span><br></pre></td></tr></table></figure>
<h1 id="代码走查：">代码走查：</h1><p>代码走查不同于仅阅读程序或使用错误检查列表，代码走查的参与者“使用了计算机”。被指定为测试人员的那个人会带着一些书面的测试用例来参加会议。在会议期间，每个测试用例都在人们脑中进行推演，也就是说，把测试数据沿程序的逻辑结构走一遍。程序的状态（如变量的值）记录在纸张或白板上以供监视。</p>
<p>这些测试用例必须结构简单，数量较少。因为人脑执行程序的速度比计算机执行程序的速度慢上若干量级。因此，这些测试用例本身并不起到关键的作用。它们的作用是提供了启动代码走查和质疑程序员逻辑思路及其设想的手段。在大多数的代码走查中，很多问题是在向程序员提问的过程中发现的，而不是由测试用例本身直接发现的。</p>
<h1 id="桌面检查：">桌面检查：</h1><p>可以视为由单人进行的代码检查或代码走查。</p>
<h1 id="同行评分：">同行评分：</h1><p>同行评分是一种依据程序整体质量，可维护性、可扩展性、易用性和清晰性对匿名程序进行评价的技术。</p>
<p>程序是否易于理解<br>高层次的设计是否可见且合理<br>低层次的设计是否可见且合理<br>修改此程序对评审者而言是否容易<br>评审者是否会以编写出该程序而骄傲<br><img title="imageTitle" alt="Desc" class="class1" src="http://7xohxb.com1.z0.glb.clouddn.com/static/images/baofoo.png?imageView2/2/w/600"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2016Note/">2016Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Payment/">Payment</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-金融相关从业风险" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/24/金融相关从业风险/" class="article-date">
  	<time datetime="2016-03-24T00:58:01.000Z" itemprop="datePublished">2016-03-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/24/金融相关从业风险/">金融相关从业风险</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h1 id="风险事件">风险事件</h1><p>在金融的相关领域转眼七年，一直从事软件开发，管理及其相关工作。几乎所有的风险都是人为的因素为主，设计缺陷，逻辑陷阱……同一个坑埋下去了一批又一批的同仁。<br>行业里面著名的“瑞穗证券的乌龙指事件”，已经落下帷幕。高收入高风险</p>
<img title="imageTitle" alt="Desc" class="class1" src="http://7xohxb.com1.z0.glb.clouddn.com/static/images/baofoo.png?imageView2/2/w/600">
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2016Note/">2016Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Payment/">Payment</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-自动化运维" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/22/自动化运维/" class="article-date">
  	<time datetime="2016-03-22T10:11:59.000Z" itemprop="datePublished">2016-03-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/22/自动化运维/">自动化运维</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<p>基础技术选型</p>
<p>前端 python flask<br>后端 saltstack</p>
<p>业务监控 cat<br>日志分析 <a href="http://kibana.logstash.es/" target="_blank" rel="external">ELK</a></p>
<img title="imageTitle" alt="Desc" class="class1" src="http://7xohxb.com1.z0.glb.clouddn.com/static/images/baofoo.png?imageView2/2/w/600">
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2016Note/">2016Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Payment/">Payment</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Fastdfs-5-08安装集成Fastdht" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/03/Fastdfs-5-08安装集成Fastdht/" class="article-date">
  	<time datetime="2016-03-03T05:31:25.000Z" itemprop="datePublished">2016-03-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/03/Fastdfs-5-08安装集成Fastdht/">Fastdfs 5.08安装集成Fastdht</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h1 id="安装FastDFS_5-08、FastDHT和fastdfs-nginx-module">安装FastDFS 5.08、FastDHT和fastdfs-nginx-module</h1><h2 id="机器端口规划">机器端口规划</h2><table>
<thead>
<tr>
<th style="text-align:center">机器IP</th>
<th style="text-align:center">ID</th>
<th style="text-align:center">fastdht</th>
<th style="text-align:center">Stroage</th>
<th style="text-align:center">tracker</th>
<th style="text-align:center">Nginx端口</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">192.168.190.31</td>
<td style="text-align:center">100001</td>
<td style="text-align:center">11411</td>
<td style="text-align:center">23000</td>
<td style="text-align:center">22122</td>
<td style="text-align:center">80  </td>
</tr>
<tr>
<td style="text-align:center">192.168.190.32</td>
<td style="text-align:center">100002</td>
<td style="text-align:center">11411</td>
<td style="text-align:center">23000</td>
<td style="text-align:center">22122</td>
<td style="text-align:center">80</td>
</tr>
<tr>
<td style="text-align:center">192.168.190.33</td>
<td style="text-align:center">100003</td>
<td style="text-align:center">11411</td>
<td style="text-align:center">23000</td>
<td style="text-align:center">22122</td>
<td style="text-align:center">80</td>
</tr>
</tbody>
</table>
<p>##安装</p>
<p><strong>1. 安装</strong></p>
<p>安装设备：所有</p>
<p>软件需求：<code>fastdfs</code>  <code>libfastcommon</code> <code>fastdht</code> <code>fastdfs-nginx-module</code></p>
<p>下载源代码编译安装</p>
<p>cd /usr/src<br>git clone <a href="https://github.com/happyfish100/libfastcommon.git" target="_blank" rel="external">https://github.com/happyfish100/libfastcommon.git</a><br>git clone <a href="https://github.com/happyfish100/fastdfs.git" target="_blank" rel="external">https://github.com/happyfish100/fastdfs.git</a><br>git clone <a href="https://github.com/happyfish100/fastdht.git" target="_blank" rel="external">https://github.com/happyfish100/fastdht.git</a><br>git clone <a href="https://github.com/happyfish100/fastdfs-nginx-module.git" target="_blank" rel="external">https://github.com/happyfish100/fastdfs-nginx-module.git</a></p>
<p><strong>优先安装<code>libfastcommon</code>解决依赖关系</strong><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装lib</span></span><br><span class="line"><span class="built_in">cd</span> /usr/src/libfastcommon</span><br><span class="line">./make.sh</span><br><span class="line">./make.sh install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装fastDHT需要安装的时候依赖Berkeley DB 4.7.25 </span></span><br><span class="line"><span class="comment"># 可以使用rpm -qa db*来查看系统是否安装,如没有请先安装优先使用yum </span></span><br><span class="line"><span class="built_in">cd</span> /usr/src/fastdht</span><br><span class="line">./make.sh</span><br><span class="line">./make.sh install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装fastDFS</span></span><br><span class="line"><span class="built_in">cd</span> /usr/src/fastdfs</span><br><span class="line">./make.sh</span><br><span class="line">./make.sh install</span><br></pre></td></tr></table></figure></p>
<p>部分系统会出现故因为依赖的问题可以参考.</p>
<pre><code>可以看到libfastcommon.so安装到了/usr/lib64/libfastcommon.so
但是<span class="constant">FastDFS</span>主程序设置的<span class="class"><span class="keyword">lib</span>目录是/<span class="title">usr</span>/<span class="title">local</span>/<span class="title">lib</span></span>
所以需要创建软链接.
ln -s /usr/lib64/libfastcommon.so /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">libfastcommon</span>.<span class="title">so</span></span>
ln -s /usr/lib64/libfastcommon.so /usr/<span class="class"><span class="keyword">lib</span>/<span class="title">libfastcommon</span>.<span class="title">so</span></span>
ln -s /usr/lib64/libfdfsclient.so /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">libfdfsclient</span>.<span class="title">so</span></span>
ln -s /usr/lib64/libfdfsclient.so /usr/<span class="class"><span class="keyword">lib</span>/<span class="title">libfdfsclient</span>.<span class="title">so</span> </span>
</code></pre><p>优先安装<code>Berkeley DB</code>解决依赖关系：<br>Berkeley DB 安装</p>
<pre><code>tar zxvf db-<span class="number">4.7</span><span class="number">.25</span>.tar.gz
cd db-<span class="number">4.7</span><span class="number">.25</span>/build_unix
../dist/configure --prefix=/usr
make &amp;&amp; make install
</code></pre><p>安装设备：所有</p>
<p>软件需求：<code>nginx</code> <code>fastdfs-nginx-module</code></p>
<p>下载安装包: <code>fastdfs-nginx-module</code> </p>
<p>解决依赖关系：</p>
<pre><code>yum -y <span class="operator"><span class="keyword">install</span> gcc gcc-<span class="keyword">c</span>++ autoconf automake glibc-devel make openssl-devel pcre-devel</span>
</code></pre><hr>
<p>编译安装nginx追加模块(Nginx 安装不做介绍请自行安装)</p>
<p>./configure –add-module=/usr/src/fastdfs-nginx-module/src<br>make<br>make install</p>
<h2 id="配置">配置</h2><h3 id="FastDHT">FastDHT</h3><p>配置与FastDHT相关参数</p>
<p>/etc/fdht/fdhtd.conf<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="setting">disabled=<span class="value"><span class="keyword">false</span></span></span></span><br><span class="line"><span class="setting">bind_addr=<span class="value"><span class="number">192.168</span>.<span class="number">190.31</span></span></span></span><br><span class="line"><span class="setting">port=<span class="value"><span class="number">11411</span></span></span></span><br><span class="line"><span class="setting">connect_timeout=<span class="value"><span class="number">5</span></span></span></span><br><span class="line"><span class="setting">network_timeout=<span class="value"><span class="number">60</span></span></span></span><br><span class="line"><span class="setting">base_path=<span class="value">/data/DFS/fastdht</span></span></span><br><span class="line"><span class="setting">max_connections=<span class="value"><span class="number">256</span></span></span></span><br><span class="line"><span class="setting">accept_threads=<span class="value"><span class="number">1</span></span></span></span><br><span class="line"><span class="setting">max_threads=<span class="value"><span class="number">8</span></span></span></span><br><span class="line"><span class="setting">max_pkg_size=<span class="value"><span class="number">64</span>KB</span></span></span><br><span class="line"><span class="setting">min_buff_size=<span class="value"><span class="number">64</span>KB</span></span></span><br><span class="line"><span class="setting">store_type = <span class="value">BDB</span></span></span><br><span class="line"><span class="setting">cache_size = <span class="value"><span class="number">64</span>MB</span></span></span><br><span class="line"><span class="setting">db_prefix = <span class="value">db</span></span></span><br><span class="line"><span class="setting">page_size = <span class="value"><span class="number">4096</span></span></span></span><br><span class="line"><span class="setting">db_type = <span class="value">btree</span></span></span><br><span class="line"><span class="setting">mpool_init_capacity = <span class="value"><span class="number">10000</span></span></span></span><br><span class="line"><span class="setting">mpool_load_factor = <span class="value"><span class="number">0.75</span></span></span></span><br><span class="line"><span class="setting">mpool_htable_lock_count = <span class="value"><span class="number">1361</span></span></span></span><br><span class="line"><span class="setting">mpool_clear_min_interval = <span class="value"><span class="number">30</span></span></span></span><br><span class="line"><span class="setting">log_level=<span class="value">info</span></span></span><br><span class="line"><span class="setting">run_by_group=</span><br><span class="line"><span class="value">run_by_user=</span></span></span><br><span class="line"><span class="setting">allow_hosts=<span class="value">*</span></span></span><br><span class="line"><span class="setting">sync_log_buff_interval=<span class="value"><span class="number">10</span></span></span></span><br><span class="line"><span class="setting">sync_db_time_base=<span class="value"><span class="number">00</span>:<span class="number">00</span></span></span></span><br><span class="line"><span class="setting">sync_db_interval=<span class="value"><span class="number">86400</span></span></span></span><br><span class="line"><span class="setting">write_to_binlog=<span class="value"><span class="number">1</span></span></span></span><br><span class="line"><span class="setting">sync_binlog_buff_interval=<span class="value"><span class="number">60</span></span></span></span><br><span class="line"><span class="setting">need_clear_expired_data=<span class="value"><span class="keyword">true</span></span></span></span><br><span class="line"><span class="setting">clear_expired_time_base=<span class="value"><span class="number">04</span>:<span class="number">00</span></span></span></span><br><span class="line"><span class="setting">clear_expired_interval=<span class="value"><span class="number">86400</span></span></span></span><br><span class="line"><span class="setting">db_dead_lock_detect_interval=<span class="value"><span class="number">1000</span></span></span></span><br><span class="line"><span class="setting">compress_binlog_time_base=<span class="value"><span class="number">02</span>:<span class="number">00</span></span></span></span><br><span class="line"><span class="setting">compress_binlog_interval=<span class="value"><span class="number">86400</span></span></span></span><br><span class="line"><span class="setting">sync_stat_file_interval=<span class="value"><span class="number">300</span></span></span></span><br><span class="line"><span class="setting">write_mark_file_freq=<span class="value"><span class="number">5000</span></span></span></span><br><span class="line"><span class="setting">thread_stack_size=<span class="value"><span class="number">1</span>MB</span></span></span><br><span class="line"><span class="setting">if_alias_prefix=</span><br><span class="line"><span class="value">store_sub_keys=<span class="keyword">false</span></span></span></span><br></pre></td></tr></table></figure></p>
<h3 id="FastDFS">FastDFS</h3><ol>
<li>安装设备：tracker</li>
</ol>
<p>mkdir -p /data/DFS/fastdfs<br>修改FastDFS 配置文件tracker.conf<br>vim /etc/fdfs/tracker.conf<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">disabled=<span class="literal">false</span></span><br><span class="line">bind_addr=<span class="number">192.168</span><span class="number">.190</span><span class="number">.31</span>              <span class="preprocessor"># 根据机器的实际IP设置</span></span><br><span class="line">port=<span class="number">22122</span></span><br><span class="line">connect_timeout=<span class="number">30</span></span><br><span class="line">network_timeout=<span class="number">60</span></span><br><span class="line">base_path=/data/DFS/fastdfs</span><br><span class="line">max_connections=<span class="number">256</span></span><br><span class="line">accept_threads=<span class="number">1</span></span><br><span class="line">work_threads=<span class="number">4</span>                       <span class="preprocessor"># 先设置为<span class="number">4</span>,后期可以调整最大为<span class="number">24</span></span></span><br><span class="line">store_lookup=<span class="number">0</span></span><br><span class="line">store_group=group2</span><br><span class="line">store_server=<span class="number">0</span></span><br><span class="line">store_path=<span class="number">0</span></span><br><span class="line">download_server=<span class="number">0</span></span><br><span class="line">reserved_storage_space = <span class="number">10</span>%</span><br><span class="line">log_level=info</span><br><span class="line">run_by_group=</span><br><span class="line">run_by_user=</span><br><span class="line">allow_hosts=*</span><br><span class="line">sync_log_buff_interval = <span class="number">10</span></span><br><span class="line">check_active_interval = <span class="number">120</span></span><br><span class="line">thread_stack_size = <span class="number">64</span>KB</span><br><span class="line">storage_ip_changed_auto_adjust = <span class="literal">true</span></span><br><span class="line">storage_sync_file_max_delay = <span class="number">86400</span></span><br><span class="line">storage_sync_file_max_time = <span class="number">300</span></span><br><span class="line">use_trunk_file = <span class="literal">false</span> </span><br><span class="line">slot_min_size = <span class="number">256</span></span><br><span class="line">slot_max_size = <span class="number">16</span>MB</span><br><span class="line">trunk_file_size = <span class="number">64</span>MB</span><br><span class="line">trunk_create_file_advance = <span class="literal">false</span></span><br><span class="line">trunk_create_file_time_base = <span class="number">02</span>:<span class="number">00</span></span><br><span class="line">trunk_create_file_interval = <span class="number">86400</span></span><br><span class="line">trunk_create_file_space_threshold = <span class="number">20</span>G</span><br><span class="line">trunk_init_check_occupying = <span class="literal">false</span></span><br><span class="line">trunk_init_reload_from_binlog = <span class="literal">false</span></span><br><span class="line">trunk_compress_binlog_min_interval = <span class="number">0</span></span><br><span class="line">use_storage_id = <span class="literal">false</span></span><br><span class="line">storage_ids_filename = storage_ids.conf</span><br><span class="line">id_type_in_filename = ip</span><br><span class="line">store_slave_file_use_link = <span class="literal">false</span></span><br><span class="line">rotate_error_log = <span class="literal">false</span></span><br><span class="line">error_log_rotate_time=<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">rotate_error_log_size = <span class="number">0</span></span><br><span class="line">log_file_keep_days =<span class="number">7</span></span><br><span class="line">use_connection_pool = <span class="literal">false</span></span><br><span class="line">connection_pool_max_idle_time = <span class="number">3600</span></span><br><span class="line">http.server_port=<span class="number">8080</span></span><br><span class="line">http.check_alive_interval=<span class="number">30</span></span><br><span class="line">http.check_alive_type=tcp</span><br><span class="line">http.check_alive_uri=/status.html</span><br></pre></td></tr></table></figure></p>
<p>/etc/fdht/fdht_servers.conf<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">group_count = <span class="number">1</span></span><br><span class="line">group0 = <span class="number">192.168</span><span class="number">.190</span><span class="number">.31</span>:<span class="number">11411</span></span><br><span class="line">group0 = <span class="number">192.168</span><span class="number">.190</span><span class="number">.32</span>:<span class="number">11411</span></span><br><span class="line">group0 = <span class="number">192.168</span><span class="number">.190</span><span class="number">.33</span>:<span class="number">11411</span></span><br></pre></td></tr></table></figure></p>
<ol>
<li>安装设备：storage<br>创建数据存放目录<br>mkdir -p /data/DFS/fastdfs<br>ln -s /data/DFS/fastdfs/data /data/DFS/fastdfs/data/M00<br>修改FastDFS 配置文件storage.conf<br>vim /etc/fdfs/storage.conf<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">disabled=<span class="literal">false</span></span><br><span class="line">group_name=group1</span><br><span class="line">bind_addr=<span class="number">192.168</span><span class="number">.190</span><span class="number">.31</span>        <span class="preprocessor"># 根据机器的实际IP设置</span></span><br><span class="line">client_bind=<span class="literal">true</span></span><br><span class="line">port=<span class="number">23000</span></span><br><span class="line">connect_timeout=<span class="number">30</span></span><br><span class="line">network_timeout=<span class="number">60</span></span><br><span class="line">heart_beat_interval=<span class="number">30</span></span><br><span class="line">stat_report_interval=<span class="number">60</span></span><br><span class="line">base_path=/data/DFS/fastdfs</span><br><span class="line">max_connections=<span class="number">256</span></span><br><span class="line">buff_size = <span class="number">256</span>KB</span><br><span class="line">accept_threads=<span class="number">1</span></span><br><span class="line">work_threads=<span class="number">24</span>                 <span class="preprocessor"># 根据CPU的核心数量设置</span></span><br><span class="line">disk_rw_separated = <span class="literal">true</span></span><br><span class="line">disk_reader_threads = <span class="number">1</span></span><br><span class="line">disk_writer_threads = <span class="number">1</span></span><br><span class="line">sync_wait_msec=<span class="number">50</span></span><br><span class="line">sync_interval=<span class="number">0</span></span><br><span class="line">sync_start_time=<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">sync_end_time=<span class="number">23</span>:<span class="number">59</span></span><br><span class="line">write_mark_file_freq=<span class="number">500</span></span><br><span class="line">store_path_count=<span class="number">1</span></span><br><span class="line">store_path0=/data/DFS/fastdfs</span><br><span class="line">subdir_count_per_path=<span class="number">256</span></span><br><span class="line">tracker_server=<span class="number">192.168</span><span class="number">.190</span><span class="number">.31</span>:<span class="number">22122</span>   <span class="preprocessor"># 并行配置多个可重复</span></span><br><span class="line">tracker_server=<span class="number">192.168</span><span class="number">.190</span><span class="number">.32</span>:<span class="number">22122</span>   <span class="preprocessor"># 并行配置多个可重复</span></span><br><span class="line">tracker_server=<span class="number">192.168</span><span class="number">.190</span><span class="number">.33</span>:<span class="number">22122</span>   <span class="preprocessor"># 并行配置多个可重复</span></span><br><span class="line">log_level=info</span><br><span class="line">run_by_group=                         <span class="preprocessor"># 运行用户组,不设置为当前</span></span><br><span class="line">run_by_user=                          <span class="preprocessor"># 运行用户组,不设置为当前</span></span><br><span class="line">allow_hosts=*                 </span><br><span class="line">file_distribute_path_mode=<span class="number">0</span></span><br><span class="line">file_distribute_rotate_count=<span class="number">100</span></span><br><span class="line">fsync_after_written_bytes=<span class="number">0</span></span><br><span class="line">sync_log_buff_interval=<span class="number">10</span></span><br><span class="line">sync_binlog_buff_interval=<span class="number">10</span></span><br><span class="line">sync_stat_file_interval=<span class="number">300</span></span><br><span class="line">thread_stack_size=<span class="number">512</span>KB</span><br><span class="line">upload_priority=<span class="number">10</span></span><br><span class="line">if_alias_prefix=</span><br><span class="line">check_file_duplicate=<span class="number">1</span>               <span class="preprocessor"># fastDHT配置,为<span class="number">1</span>开启</span></span><br><span class="line">file_signature_method=hash</span><br><span class="line">key_namespace=FastDFS</span><br><span class="line">keep_alive=<span class="number">1</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> /etc/fdht/fdht_servers.conf  #  引用fastDHT配置</span></span><br><span class="line">use_access_log = <span class="literal">false</span></span><br><span class="line">rotate_access_log = <span class="literal">false</span></span><br><span class="line">access_log_rotate_time=<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">rotate_error_log = <span class="literal">false</span></span><br><span class="line">error_log_rotate_time=<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">rotate_access_log_size = <span class="number">0</span></span><br><span class="line">rotate_error_log_size = <span class="number">0</span></span><br><span class="line">log_file_keep_days = <span class="number">7</span>                <span class="preprocessor"># 日志文件保存一周</span></span><br><span class="line">file_sync_skip_invalid_record=<span class="literal">false</span></span><br><span class="line">use_connection_pool = <span class="literal">false</span></span><br><span class="line">connection_pool_max_idle_time = <span class="number">3600</span></span><br><span class="line">http.domain_name=</span><br><span class="line">http.server_port=<span class="number">8888</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>/etc/fdfs/storage_ids.conf<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">100001</span>   group1  <span class="number">192.168</span><span class="number">.190</span><span class="number">.31</span></span><br><span class="line"><span class="number">100002</span>   group1  <span class="number">192.168</span><span class="number">.190</span><span class="number">.32</span></span><br><span class="line"><span class="number">100003</span>   group1  <span class="number">192.168</span><span class="number">.190</span><span class="number">.33</span></span><br></pre></td></tr></table></figure></p>
<p>其他参考实施脚本~<br>mkdir -p /data/DFS/fastdht<br>sed -i ‘s#192.168.190.31#192.168.190.32#g’ /etc/fdht/fdhtd.conf<br>sed -i ‘s#192.168.190.31#192.168.190.33#g’ /etc/fdht/fdhtd.conf</p>
<p>mkdir -p /data/DFS/fastdfs<br>sed -i ‘s#192.168.190.31#192.168.190.32#g’ /etc/fdfs/storage.conf<br>sed -i ‘s#192.168.190.31#192.168.190.32#g’ /etc/fdfs/tracker.conf<br>mkdir -p /data/DFS/fastdfs<br>sed -i ‘s#192.168.190.31#192.168.190.33#g’ /etc/fdfs/storage.conf<br>sed -i ‘s#192.168.190.31#192.168.190.33#g’ /etc/fdfs/tracker.conf </p>
<h3 id="启动&amp;停止">启动&amp;停止</h3><p>启动脚本<br>fdhtd /etc/fdht/fdhtd.conf<br>fdfs_trackerd /etc/fdfs/tracker.conf<br>fdfs_storaged /etc/fdfs/storage.conf<br>停止<br>killall fdfs_storaged<br>killall fdfs_trackerd<br>killall fdhtd</p>
<h3 id="nginx">nginx</h3><p>上层转发nginx增加配置</p>
<pre><code><span class="title">vim</span> /usr/local/nginx/conf/nginx.conf
<span class="comment">#user  nobody;</span>
worker_processes  <span class="number">24</span>;   <span class="comment">#通常设置为CPU 数</span>

<span class="title">http</span> {
    <span class="title">include</span>       mime.types;
    <span class="title">default_type</span>  application/octet-stream;

    <span class="comment">#log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span>
    <span class="comment">#                  '$status $body_bytes_sent "$http_referer" '</span>
    <span class="comment">#                  '"$http_user_agent" "$http_x_forwarded_for"';</span>

    <span class="comment">#access_log  logs/access.log  main;</span>

    <span class="title">sendfile</span>        <span class="built_in">on</span>;
    <span class="comment">#tcp_nopush     on;</span>

    <span class="comment">#keepalive_timeout  0;</span>
    <span class="title">keepalive_timeout</span>  <span class="number">65</span>;

    <span class="comment">#gzip  on;</span>

    <span class="title">upstream</span> server_dfs{            <span class="comment"># 新增</span>
    <span class="title">server</span> <span class="number">192.168.190.31:80</span>;       <span class="comment"># 新增</span>
    <span class="title">server</span> <span class="number">192.168.190.32:80</span>;       <span class="comment"># 新增</span>
    <span class="title">server</span> <span class="number">192.168.190.33:80</span>;       <span class="comment"># 新增</span>
    }                               <span class="comment"># 新增</span>

    <span class="title">server</span> {
        <span class="title">listen</span>       <span class="number">80</span>;
        <span class="title">server_name</span>  localhost;

        <span class="comment">#charset koi8-r;</span>

        <span class="comment">#access_log  logs/host.access.log  main;</span>

    <span class="title">location</span> ~/group\\d {                                           <span class="comment"># 新增</span>
        <span class="title">proxy_redirect</span> <span class="built_in">off</span>;                                         <span class="comment"># 新增</span>
        <span class="title">proxy_set_header</span> Host <span class="variable">$host</span>;                                <span class="comment"># 新增</span>
        <span class="title">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;                    <span class="comment"># 新增</span>
        <span class="title">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;<span class="comment"># 新增</span>
        <span class="title">proxy_pass</span> <span class="url">http://server_dfs</span>;                               <span class="comment"># 新增</span>
    }                                                               <span class="comment"># 新增</span>
}
</code></pre><p>2.安装设备：storage</p>
<p>编译nginx时添加了fastdfs-nginx-module：</p>
<pre><code>拷贝FastDFS目录下的文件：<span class="regexp">/usr/</span>src<span class="regexp">/fdstdfs/</span>conf<span class="regexp">/目录下：http.conf mime.types到/</span>etc/fdfs目录下
cd <span class="regexp">/usr/</span>src<span class="regexp">/fdstdfs/</span>conf/
cp http.conf mime.types <span class="regexp">/etc/</span>fdfs
</code></pre><p>修改nginx配置文件</p>
<pre><code>vim /usr/local/nginx/conf/nginx.conf

#user  nobody<span class="comment">;</span>
#  原值为1,修改为24 by muyan <span class="number">20151203</span>
worker_processes  24<span class="comment">;</span>

http {
    include       mime.types<span class="comment">;</span>
    default_type  application/octet-stream<span class="comment">;</span>

    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    #                  '$status $body_bytes_sent "$http_referer" '
    #                  '"$http_user_agent" "$http_x_forwarded_for"'<span class="comment">;</span>

    #access_log  logs/access.log  main<span class="comment">;</span>

    sendfile        on<span class="comment">;</span>
    #tcp_nopush     on<span class="comment">;</span>

    #keepalive_timeout  0<span class="comment">;</span>
    keepalive_timeout  65<span class="comment">;</span>

    #gzip  on<span class="comment">;</span>

    server {
        listen       80<span class="comment">;</span>
        server_name  localhost<span class="comment">;</span>

        #charset koi8-r<span class="comment">;</span>

        #access_log  logs/host.access.log  main<span class="comment">;</span>

        location / {
            root   html<span class="comment">;</span>
            index  index.html index.htm<span class="comment">;</span>
        }

    # 新增开始 by muyan <span class="number">20151203</span>
    location ~/group\\d+/M00 {            
        root   /data/DFS/fastdfs/data/<span class="comment">;        </span>
        ngx_fastdfs_module<span class="comment">;                       </span>
    }
    # 新增结束 by muyan <span class="number">20151203</span>
｝
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2016Note/">2016Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Payment/">Payment</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-日志规范" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/13/日志规范/" class="article-date">
  	<time datetime="2016-01-13T02:36:37.000Z" itemprop="datePublished">2016-01-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/13/日志规范/">日志规范</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h1 id="系统开发日志输出规范">系统开发日志输出规范</h1><h2 id="日志应该遵循：简短，有效，可追溯三个最基本原则。">日志应该遵循：简短，有效，可追溯三个最基本原则。</h2><h3 id="日志分类（参考）">日志分类（参考）</h3><ul>
<li>行为日志<ul>
<li>UI切换，事件触发，页面 （页面和客户端）</li>
</ul>
</li>
<li>性能日志<ul>
<li>网络日志，性能埋点  （服务端，客户端）</li>
</ul>
</li>
<li>异常日志<ul>
<li>闪退，流量，电量  （客户端）</li>
</ul>
</li>
<li>服务日志 <ul>
<li>TraceLog，业务日志 （服务端）</li>
</ul>
</li>
</ul>
<h3 id="详细描述">详细描述</h3><p>主要规范日志的要求，在系统建设时期加强日志的输出规范，以协助其他生产系统和应用更早的发现故障;定位问题;减少人工干预;<br><em>服务日志</em>：在每个系统的入口和出口输出，（在调用外部系统之前，或者收到外部消息通知的时候输出）</p>
<h4 id="详解典型流程中的日志输出">详解典型流程中的日志输出</h4><img title="imageTitle" alt="Desc" class="class1" src="http://7xohxb.com1.z0.glb.clouddn.com/static/images/flow-webpay.png?imageView2/2/w/600">
<p>输出节点：</p>
<ul>
<li>外部消息交互<ul>
<li>主动交互（查询外部接口，支付接口等）</li>
<li>被动交互（提供服务被调用，银行通知接口）</li>
</ul>
</li>
<li>内部系统调用<ul>
<li>收单调用会员</li>
<li>交易调用账户</li>
<li>调用通知模块</li>
<li>调用账户等~<h4 id="参考日志输出模型">参考日志输出模型</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.common.base.Objects;</span><br><span class="line"><span class="keyword">import</span> com.google.common.base.Strings;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 日志跟踪模型</span><br><span class="line"> * &lt;p/&gt;</span><br><span class="line"> * &lt;p&gt;创建日志跟踪ID，并根据上一层级的ID产生直接的ID。使整个系统的日志能根据ID和时间，真实还原系统的调用关系。</span><br><span class="line"> *</span><br><span class="line"> * <span class="doctag">@author</span> muyan<span class="doctag">@baofoo</span>.com</span><br><span class="line"> * <span class="doctag">@version</span> 1.0.0 Created on 2016/1/2.</span><br><span class="line"> * <span class="doctag">@see</span></span><br><span class="line"> * <span class="doctag">@since</span> 1.7</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogTraceModle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * UUID系统产生向后传递，且不能变化</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> String traceID = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 路由ID，反映系统之间的调用的层级关系，系统默认传出的ID为当前系统，入口系统为0.0</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> String routeID = <span class="string">"0"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 系统ID，默认分配</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> String systemID;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTraceID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 初始化系统</span></span><br><span class="line">        <span class="keyword">if</span> (Strings.isNullOrEmpty(traceID)) &#123;</span><br><span class="line">            traceID = String.valueOf(UUID.randomUUID());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> traceID;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRouteID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> routeID;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 设置当前系统的</span><br><span class="line">     * <span class="doctag">@param</span> routeID</span><br><span class="line">     * <span class="doctag">@param</span> systemID</span><br><span class="line">     * <span class="doctag">@param</span> isSync  处理方式为同步系统为</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTraceModle</span><span class="params">( String systemID,<span class="keyword">boolean</span> isSync)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 同步调用处理开始</span></span><br><span class="line">        <span class="keyword">if</span> (isSync) &#123;</span><br><span class="line">            <span class="keyword">int</span> index = routeID.lastIndexOf(<span class="string">"."</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">0</span> &lt; index) &#123;</span><br><span class="line">                String end = routeID.substring(index + <span class="number">1</span>);</span><br><span class="line">                String next = String.valueOf(Integer.parseInt(end) + <span class="number">1</span>);</span><br><span class="line">                routeID = routeID.substring(<span class="number">0</span>, index + <span class="number">1</span>) + next;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                routeID = String.valueOf(Integer.parseInt(routeID) + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            routeID = routeID.concat(<span class="string">".1"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.systemID = systemID;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSystemID</span><span class="params">(String systemID)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.systemID = systemID;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (Strings.isNullOrEmpty(traceID)) &#123;</span><br><span class="line">            traceID = String.valueOf(UUID.randomUUID());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Objects.toStringHelper(<span class="keyword">this</span>)</span><br><span class="line">                .add(<span class="string">"traceID"</span>, traceID)</span><br><span class="line">                .add(<span class="string">"routeID"</span>, routeID)</span><br><span class="line">                .add(<span class="string">"systemID"</span>, systemID)</span><br><span class="line">                .toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>测试上图流程标准日志输出代码<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">LogTraceModle&#123;traceID=4aa55d7a-f95d-4f7a-b3e1-223b4bf00d9a, routeID=1, systemID=宝付用户发起支付&#125;</span><br><span class="line">LogTraceModle&#123;traceID=4aa55d7a-f95d-4f7a-b3e1-223b4bf00d9a, routeID=2, systemID=支付网关收单&#125;</span><br><span class="line">LogTraceModle&#123;traceID=4aa55d7a-f95d-4f7a-b3e1-223b4bf00d9a, routeID=2.1, systemID=查询宝付账户信息&#125;</span><br><span class="line">LogTraceModle&#123;traceID=4aa55d7a-f95d-4f7a-b3e1-223b4bf00d9a, routeID=2.2, systemID=订单入库&#125;</span><br><span class="line">LogTraceModle&#123;traceID=4aa55d7a-f95d-4f7a-b3e1-223b4bf00d9a, routeID=2.3, systemID=收银台&#125;</span><br><span class="line">LogTraceModle&#123;traceID=4aa55d7a-f95d-4f7a-b3e1-223b4bf00d9a, routeID=2.3.1, systemID=银行网关&#125;</span><br><span class="line">LogTraceModle&#123;traceID=4aa55d7a-f95d-4f7a-b3e1-223b4bf00d9a, routeID=2.3.2, systemID=银行回调&#125;</span><br><span class="line">LogTraceModle&#123;traceID=4aa55d7a-f95d-4f7a-b3e1-223b4bf00d9a, routeID=2.3.3, systemID=宝付处理成功订单&#125;</span><br><span class="line">LogTraceModle&#123;traceID=4aa55d7a-f95d-4f7a-b3e1-223b4bf00d9a, routeID=2.3.3.1, systemID=通知商家&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">被外部系统调用的系统可以直接NewModel对象。</span><br><span class="line">然后通过下面的方法设置系统和调用方式，同步调用为Boolean.TRUE,异步为Boolean.<span class="function">FALSE</span><br><span class="line"><span class="title">setTraceModle</span><span class="params">(String systemID,<span class="keyword">boolean</span> isSync)</span></span><br><span class="line">调用内部系统传递要求使用JSON对模型进行序列化。</span><br><span class="line">如fastjson JSON.<span class="title">toJSONString</span><span class="params">(LogTraceModle)</span>.</span><br><span class="line"></span><br><span class="line">内部系统收到调用；先转为对象后重新设置</span><br><span class="line"><span class="title">setTraceModle</span><span class="params">(String systemID,<span class="keyword">boolean</span> isSync)</span></span></span><br></pre></td></tr></table></figure>
<p>标示于原到系统为下图<br><img title="imageTitle" alt="Desc" class="class1" src="http://7xohxb.com1.z0.glb.clouddn.com/static/images/flow-webpay2.png?imageView2/2/w/600"></p>
<p>关于多线程处理的业务可以加上LogTraceModle后把线程ID加上，严格意义上不同的订单需要不同的LogTraceModle，对于后台拆分的订单（大额下发），建议使用相同的LogTraceModle。保证订单数据的完整性。</p>
<p>关于日志系统配置<br>通过slf4j MDC设置 <a href="http://logback.qos.ch/manual/mdc.html#autoMDC" target="_blank" rel="external">参考</a> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">LogTraceModle logTraceModle = <span class="keyword">new</span> LogTraceModle();</span><br><span class="line">logTraceModle.setTraceModle(<span class="string">"宝付用户发起支付"</span>, Boolean.TRUE);</span><br><span class="line">MDC.put(LogTraceModle, logTraceModle.toString());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始业务处理</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 业务处理结束</span></span><br><span class="line">MDC.remove(LogTraceModle);</span><br></pre></td></tr></table></figure>
<p>需要在logback的配置中加上<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"log.base"</span> <span class="attribute">value</span>=<span class="value">"./log/logback"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="title">appender</span> <span class="attribute">name</span>=<span class="value">"stdout"</span> <span class="attribute">class</span>=<span class="value">"ch.qos.logback.core.ConsoleAppender"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">encoder</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="title">pattern</span>&gt;</span> %X&#123;LogTraceModle&#125; %date [%thread] %-5level %logger&#123;80&#125; - %msg%n</span><br><span class="line">       <span class="tag">&lt;/<span class="title">pattern</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="title">encoder</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="title">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="title">appender</span> <span class="attribute">name</span>=<span class="value">"logfile"</span></span><br><span class="line">     <span class="attribute">class</span>=<span class="value">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">File</span>&gt;</span> $&#123;log.base&#125;.log<span class="tag">&lt;/<span class="title">File</span> &gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">rollingPolicy</span> <span class="attribute">class</span>=<span class="value">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="title">FileNamePattern</span>&gt;</span> $&#123;log.base&#125;.%d&#123;yyyy -MM-dd&#125;.log.zip <span class="tag">&lt;/<span class="title">FileNamePattern</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="title">rollingPolicy</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">encoder</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="title">pattern</span>&gt;</span> %X&#123;LogTraceModle&#125; %date [%thread] %-5level %logger&#123;80&#125; - %msg%n</span><br><span class="line">       <span class="tag">&lt;/<span class="title">pattern</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="title">encoder</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="title">appender</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"com.sample"</span> <span class="attribute">level</span>=<span class="value">"TRACE"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="title">root</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"INFO"</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout"</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"logfile"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="title">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="后记">后记</h3><p>异常日志等在后续的文档中规范。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2016Note/">2016Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Payment/">Payment</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Muyan Xia
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: /
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>